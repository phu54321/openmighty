!function(e){function n(r){if(a[r])return a[r].exports;var t=a[r]={exports:{},id:r,loaded:!1};return e[r].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var a={};return n.m=e,n.c=a,n.p="",n(0)}([function(e,n,a){"use strict";a(1),a(2),a(3),$(function(){$("#jokerCall").modal("open")})},function(e,n){"use strict";function a(e){return!0}function r(e){return""!==e}function t(e,n,r,t){var d=$("#"+n),o={};if(!d)return console.log("Unknown form '"+n+"'"),!1;for(var s=0;s<r.length;s++){var l=i(r[s],4),c=l[0],u=l[1],p=l[2],f=l[3];if(p||(p=a),f||(f="허용되지 않은 입력입니다."),o[u]=d.find("#"+c).val(),!p(o[u]))return window.alert(f),!1}return d.find("input, textarea").prop("disabled",!0),$.ajax({type:"POST",url:e,data:o,dataType:"json",success:function(e){e.error?(d.find("input, textarea").prop("disabled",!1),window.alert(e.error)):t(e)},error:function(e,n,a){console.log(n,"message : "+e.responseText+"\nerror : "+a)}}),!0}var i=function(){function e(e,n){var a=[],r=!0,t=!1,i=void 0;try{for(var d,o=e[Symbol.iterator]();!(r=(d=o.next()).done)&&(a.push(d.value),!n||a.length!==n);r=!0);}catch(e){t=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw i}}return a}return function(n,a){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();window.issueRegister=function(){t("/users/register","registerForm",[["username","username",r,"이름을 입력하세요."],["useridf","useridf",a,""]],function(){window.location.reload(!0)})},window.issueLogout=function(){$.ajax({type:"POST",url:"/users/logout",success:function(e){window.location.reload(!0)},error:function(e,n,a){console.log(n,"message : "+e.responseText+"\nerror : "+a)}})}},function(e,n){"use strict";$(function(){function e(e){for(var n="",a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)n+=a.charAt(Math.floor(Math.random()*a.length));return n}$("#roomURL").attr("pattern","^"+location.origin+"/[a-zA-Z0-9]{8}|$"),$("#joinRoom").submit(function(n){var a=$("#roomURL"),r=a.val();if(""===r){var t=e(8);r=window.location.origin+"/"+t,a.val(r)}window.location.href=r,n.preventDefault()})})},function(e,n,a){"use strict";var r=window.Materialize,t=window.io,i=a(4),d=void 0,o=$("#gameDiv");0!=o.length&&o.ready(function(){d=t(),d.on("err",function(e){r.toast(e,3e3)}),d.on("info",function(e){}),d.on("cmd",function(e){i.translateCmdMessage(e)}),d.on("disconnect",function(){})}),n.sendCmd=function(e,n){var a=Object.assign({},n||{});return a.type=e,d.emit("cmd",a),!0},window.sendCmd=n.sendCmd},function(e,n,a){"use strict";var r={},t=window.Materialize,i=(a(5),a(7));n.translateCmdMessage=function(e){r[e.type]?r[e.type](e):t.toast("Unknown command message type : "+e.type,4e3)},a(8)(r),a(9)(r),a(10)(r),a(11)(r),r.gabort=function(e){var n=e.msg||"게임이 중간에 종료되었습니다.";t.toast(n,3e3),i.playing=!1,i.viewRoom(),$("#title").text("openMighty")}},function(e,n,a){"use strict";var r={},t=a(6);n=e.exports=r,n.viewDeck=function(){var e=$(".deck");e.empty();for(var n=0;n<r.deck.length;n++){var a=r.deck[n],i=[a.shape,a.num],d=i[0],o=i[1],s=t(null,"deck-card"),l=d[0]+o;s.find(".game-card").attr("card",l).addClass("game-card-"+l).addClass("game-card-shape-"+d[0]),e.append(s)}},n.shapeAbbrTable={spade:"♠",heart:"♥",diamond:"♦",clover:"♣",none:"N"},n.shapeStringTable={spade:"스페이드",heart:"하트",diamond:"다이아몬드",clover:"클로버",none:"노기루다"}},function(e,n){"use strict";var a=function(){function e(e,n){var a=[],r=!0,t=!1,i=void 0;try{for(var d,o=e[Symbol.iterator]();!(r=(d=o.next()).done)&&(a.push(d.value),!n||a.length!==n);r=!0);}catch(e){t=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw i}}return a}return function(n,a){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=window.Materialize,t=["text","val","submit","click","remove","empty","addClass","removeClass"," toggleClass"],i=["disabled"];e.exports=function(e,n,d){function o(e){var n=a(e,2),r=n[0],d=n[1];t.indexOf(r)!=-1?l[r](d):i.indexOf(r)!=-1?l.prop(r,d):l.attr(r,d)}var s=$("#template-"+n).clone().removeAttr("id"),l=void 0;if(d)for(var c=0;c<d.length;c++){var u=a(d[c],2),p=u[0],f=u[1];l=p?s.find(p):s,1==l.length?Array.isArray(f[0])?f.forEach(o):(null!==f&&"string"!=typeof f||(f=[d[c][1],d[c][2]]),o(f)):(r.toast("Invalid selector : "+p,4e3),console.log("Invalid selector",d[c]))}return e&&(e.empty(),e.append(s)),s}},function(e,n,a){"use strict";function r(){var e=$(".player-self").find(".game-card-container");o(e,"button"),e.find("button").click(function(e){d.sendCmd("start"),$(".player-has").empty(),e.preventDefault()})}var t=a(5),i={playing:!1,myidf:null,owner:0,users:[]},d=a(3),o=a(6);n=e.exports=i,n.viewRoom=function(){var e=void 0,n=void 0,a=void 0;i.playing?(n=-1,e=t.gameUsers,a=t.president):(n=i.owner,e=i.users,a=-1);var d=$(".player-slot");d.removeClass("player-empty player-owner player-president player-self player-leading");for(var o=null,s=0;s<e.length;s++){var l=$(d[s]),c=e[s];l.find(".player-name").text(c.username),l.find(".game-card-container").empty(),n===s&&l.addClass("player-owner"),a===s&&l.addClass("player-president"),c.useridf==i.myidf&&(l.addClass("player-self"),o=s)}for(var u=e.length;u<5;u++){var p=$(d[u]);p.addClass("player-empty"),p.find(".player-name").text("Empty"),p.find(".game-card-container").empty(),p.find(".player-has").empty()}i.playing?t.selfIndex=o:n===o&&r()}},function(e,n,a){"use strict";var r=a(7),t=window.Materialize;e.exports=function(e){e.rjoin=function(e){t.toast(e.username+"님이 입장하셨습니다.",2e3),r.users.push({username:e.username,useridf:e.useridf}),r.viewRoom()},e.rleft=function(e){for(var n=r.users,a=0;a<n.length;a++){var i=n[a];if(i.useridf==e.useridf){t.toast(i.username+"님이 퇴장하셨습니다.",2e3),n.splice(a,1);break}}r.owner=e.owner,r.playing||r.viewRoom()},e.rusers=function(e){r.owner=e.owner,r.users=e.users,r.myidf=e.youridf,r.viewRoom()}}},function(e,n,a){"use strict";var r=window.Materialize,t=a(6),i=a(5),d=a(7),o=a(3);e.exports=function(e){e.gusers=function(e){i.gameUsers=e.users,i.president=-1,i.remainingBidder=5,i.lastBidder=null,d.playing=!0,d.viewRoom()},e.deck=function(e){i.deck=e.deck,i.viewDeck()},e.pbinfo=function(e){var n=$($(".player-slot .game-card-container")[e.bidder]);"pass"!=e.bidShape&&(i.bidShape=e.bidShape,i.bidCount=e.bidCount,i.lastBidder=e.bidder),n.find(".game-card").remove();var a=$("<div/>").addClass("game-card player-card-bidding");"pass"==e.bidShape?(a.text("pass"),i.remainingBidder--):a.text(e.bidShape+" "+e.bidCount),n.append(a),1==i.remainingBidder&&null!==i.lastBidder&&(i.lastBidder!=i.selfIndex&&r.toast("공약이 끝났습니다. 기다려주세요",1500),i.president=i.lastBidder)},e.bidrq=function(){var e=i.bidCount||13;"none"==i.bidShape&&e++;var n=$(".player-self .game-card-container"),a=t(n,"bidding");a.attr("id","bidForm"),a.find('input[name="bidCount"]').attr("min",e).val(e),a.submit(function(){var e=$("#bidForm"),n=e.find('*[name="bidShape"]').val(),a=e.find('*[name="bidCount"]').val();return o.sendCmd("bid",{shape:n,num:parseInt(a)}),!1})},e.bc1rq=function(){r.toast("공약을 수정해주세요.",1500);var e=i.bidShape,n=i.bidCount,a=$(".player-self .game-card-container");t(a,"bidding",[[null,["id","bidChangeForm"]],[".player-form-title",["text","현재 : "+i.shapeAbbrTable[e]+n]],['input[name="bidCount"]',[["min",n],["val",n]]],['option[value="'+e+'"]',["remove"]],['option[value="pass"]',[["val",e],["text","그대로 ("+i.shapeStringTable[e]+")"]]],[null,["submit",function(){var e=$("#bidChangeForm"),n=e.find('*[name="bidShape"]').val(),a=e.find('*[name="bidCount"]').val();return n==i.bidShape&&a==i.bidCount&&(n="pass"),o.sendCmd("bc1",{shape:n,num:parseInt(a)}),!1}]]])},e.binfo=function(e){$(".player-slot .game-card-container").empty();var n=i.shapeStringTable[e.shape]+" "+e.num;r.toast("공약 : "+n,1500),$("#title").text("openMighty - "+n),i.bidShape=e.shape,i.bidCount=e.num,i.president=e.president,$($(".player-slot")[i.president]).addClass("player-leading player-president")}}},function(e,n,a){"use strict";var r=window.Materialize,t=window._,i=a(6),d=(a(7),a(5)),o=a(3),s=a(11);e.exports=function(e){function n(e){return{mighty:{shape:"spade"==e?"diamond":"spade",num:14},joker:{shape:"joker",num:0},girudaA:{shape:e,num:14},girudaK:{shape:e,num:13}}}function a(e,a,r){var t=n(e);if(t[a]){var i=t[a];return r.ftype="card",r.shape=i.shape,r.num=i.num,!0}return"first"==a?(r.ftype="first",!0):"none"==a&&(r.ftype="none",!0)}function l(e,a){var r=n(e);if("card"==a.ftype){var i=null;return t.keys(r).some(function(e){var n=r[e];if(n.shape==a.args.shape&&n.num==a.args.num)return i=e,!0}),i}return"first"==a.ftype?"first":"none"==a.ftype?"none;":null}e.fsrq=function(){r.toast("카드 3장을 버리고 프렌드를 선정하세요",1500),$(".deck-card").click(function(){$(this).toggleClass("deck-card-selected")});var e=d.bidCount,n=d.bidShape,t=$(".player-self .game-card-container"),s=i(t,"fselect",[[null,["id","friendSelectForm"]],["option[value="+n+"]",["remove"]],['input[name="bidCount"]',[["min",e],["val",e]]],['option[value="pass"]',["val",n]]]);s.submit(function(){for(var e={},n=$("#friendSelectForm"),t=$(".deck .deck-card").toArray(),i=[],s=0;s<t.length;s++)$(t[s]).hasClass("deck-card-selected")&&i.push(s);if(3!=i.length)return r.toast("3장을 골라주세요.",1500),!1;e.discards=i;var l=n.find('*[name="bidShape"]').val(),c=n.find('*[name="bidCount"]').val();l==d.bidShape&&c==d.bidCount||(e.bidch2={shape:l,num:parseInt(c)});var u=n.find("select[name=friendType]").val();return a(l,u,e)?(o.sendCmd("fs",e),!1):(r.toast("프렌드를 선정해주세요.",1500),!1)})},e.fs=function(e){var n=l(d.bidShape,e),a=$("#template-fselect").find('option[value="'+n+'"]').text()+" 프렌드";r.toast(a,2e3),d.ftype=e.ftype,d.fargs=e.args;var t=$("#title");t.text(t.text()+" - "+a),s.initGame()}}},function(e,n,a){"use strict";function r(){t(),l.trick++}function t(){$(".deck-card").removeClass("deck-card-selected").unbind("click")}function i(){l.trick=0,l.starter=l.president,r()}function d(e){var n=e.attr("card"),a={s:"spade",h:"heart",c:"clover",d:"diamond",j:"joker"}[n[0]],r=parseInt(n.substr(1));return{shape:a,num:r}}var o=window.Materialize,s=a(6),l=a(5),c=a(7),u=a(3);n=e.exports=function(e){function n(e){if(e.jcall){var n=$(".game-card-shape-j");if(0!==n.length)return void n.parents(".deck-card").addClass("deck-card-selectbale")}else if(e.shaperq){var a=$(".game-card-shape-"+e.shaperq[0]);if(0!==a.length)return void a.parents(".deck-card").addClass("deck-card-selectable")}$(".deck-card").addClass("deck-card-selectable")}e.cprq=function(e){o.toast("카드를 내주세요.",1500);var a=$(".player-self .game-card-container");s(a,"button",[["button",[["text","카드 내기"],["disabled",!0]]]]),n(e),$(".deck-card-selectable").click(function(){$(".deck-card").removeClass("deck-card-selected"),$(this).addClass("deck-card-selected"),a.find("button").prop("disabled",!1)}),a.find("button").click(function(){var e=$(".deck-card-selected");1!=e.length&&o.toast("카드를 선택해주세요.",1500);var n=d(e.find(".game-card"));if(1!=l.trick&&3==n.num&&("clover"==l.bidShape&&"spade"==n.shape||"clover"!=l.bidShape&&"clover"==n.shape)){var a=$("#jokerCallModal");a.find("button[name=no]").click(function(){u.sendCmd("cp",{cardIdx:e.index(".deck-card")})}),a.find("button[name=yes]").click(function(){u.sendCmd("cp",{cardIdx:e.index(".deck-card"),jcall:!0})}),a.modal({dismissible:!1}),a.modal("open")}else"joker"==n.shape&&l.starter==l.selfIndex?!function(){var n=$("#jokerModal"),a=n.find("select[name=srq]");a.val("none"),n.modal({dismissible:!1}),n.find("button").click(function(){var n=a.val();"none"==n&&(n=void 0),u.sendCmd("cp",{cardIdx:e.index(".deck-card"),srq:n})}),n.modal("open")}():u.sendCmd("cp",{cardIdx:e.index(".deck-card")})})},e.jrq=function(e){var n=e.shaperq;o.toast("조커로 "+l.shapeStringTable[n]+"를 불렀습니다.",2e3)},e.pcp=function(e){var n=e.card,a=$($(".player-slot")[e.player]);"card"==l.ftype&&l.fargs.shape==n.shape&&l.fargs.num==n.num&&a.addClass("player-leading");var r=a.find(".game-card-container"),i=n.shape[0]+n.num;s(r,"game-card",[[null,[["addClass","game-card-"+i],["card",i]]]]),t()},e.tend=function(e){var n=$($(".player-has")[e.winner]),a=$(".player-slot .game-card");a.each(function(){var e=d($(this));if(e.num>=10){var a=["10","J","Q","K","A"][e.num-10];n.append($("<div/>").addClass("has-slot").addClass("has-"+e.shape).text(a))}}),"first"==l.ftype&&l.president!=e.winner&&2!=$(".player-leading").length&&l.trick<=4&&$($(".player-slot")[e.winner]).addClass("player-leading"),a.fadeOut(1e3),l.starter=e.winner,r()},e.gend=function(e){var n=l.bidCount,a=20-e.oppcc,r=$("#gameEndModal"),t=r.find(".modal-content p");a>=n?t.text("["+a+"/"+n+"] 여당 승리입니다."):t.text("["+a+"/"+n+"] 야당 승리입니다."),c.playing=!1,r.modal({dismissible:!0,complete:function(){c.playing||(c.viewRoom(),$("#title").text("openMighty"))}}),r.modal("open")}},n.issueTrickStart=r,n.initGame=i}]);